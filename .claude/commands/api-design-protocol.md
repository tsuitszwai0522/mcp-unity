
# API Design Protocol for Claude Code

此規則為 Claude Code 執行 API 設計的行為規範，採用「契約優先」原則。

## 核心規則 (Core Rules)

1. **語言要求**：所有溝通、文件撰寫必須使用 **zh-TW**。
2. **契約優先**：必須先完成設計文件，才能開始實作。
3. **禁止搶跑**：在使用者明確表示「批准」之前，**禁止實作代碼**。

## 觸發條件 (When to Activate)

當使用者說出以下類型的請求時，啟動此流程：
- 「設計一個 API」
- 「新增端點」
- 「規劃 API 結構」

## 執行流程 (Workflow)

### 第一階段：需求釐清

1. **確認關鍵問題**：
   - 解決什麼業務問題？
   - 誰是消費者？
   - 預期呼叫頻率？

2. **建立設計文件**：
   - 在 `doc/apiDesign/` 建立 `API_{Date}_{Name}.md`。

### 第二階段：契約設計

1. **定義端點**：Method, Path, 描述。
2. **定義格式**：Request Body, Response, Error Codes。
3. **提供範例**：完整的請求/回應範例。

### 第三階段：審閱

1. **檢查一致性**：與現有 API 風格一致。
2. **檢查安全性**：認證、權限、敏感資料。
3. **檢查效能**：快取、分頁、N+1。

## 輸出規範

| 項目 | 路徑 |
|------|------|
| API 設計文件 | `doc/apiDesign/API_{Date}_{Name}.md` |

## 設計 Checklist

- [ ] 端點命名符合慣例
- [ ] HTTP 方法語意正確
- [ ] 有錯誤處理
- [ ] 有範例
- [ ] 考慮版本相容

## 禁止事項 (Don'ts)

1. ❌ 未經批准就實作
2. ❌ 不考慮錯誤處理
3. ❌ 忽略版本相容性
4. ❌ 不提供範例
